
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Draw entity relationship diagrams for Pydantic models and standard library dataclasses.">
      
      
      
        <link rel="canonical" href="https://erdantic.drivendata.org/stable/forward-references/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>Handling Forward References - erdantic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/custom_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#handling-forward-references" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="erdantic" class="md-header__button md-logo" aria-label="erdantic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            erdantic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Handling Forward References
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/drivendataorg/erdantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="erdantic" class="md-nav__button md-logo" aria-label="erdantic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    erdantic
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/drivendataorg/erdantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI Help
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Usage Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Usage Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Usage Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/pydantic/" class="md-nav__link">
        Usage Example: Pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/dataclasses/" class="md-nav__link">
        Usage Example: dataclasses
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Handling Forward References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Handling Forward References
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unevaluated-forward-references" class="md-nav__link">
    Unevaluated Forward References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#untransformed-string-forward-references" class="md-nav__link">
    Untransformed String Forward References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        Adding New Frameworks
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/base/" class="md-nav__link">
        erdantic.base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/dataclasses/" class="md-nav__link">
        erdantic.dataclasses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/erd/" class="md-nav__link">
        erdantic.erd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/exceptions/" class="md-nav__link">
        erdantic.exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/pydantic/" class="md-nav__link">
        erdantic.pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" type="checkbox" id="__nav_6_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_6">
          erdantic.examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="erdantic.examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          erdantic.examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/examples.pydantic/" class="md-nav__link">
        erdantic.examples.pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/examples.dataclasses/" class="md-nav__link">
        erdantic.examples.dataclasses
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unevaluated-forward-references" class="md-nav__link">
    Unevaluated Forward References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#untransformed-string-forward-references" class="md-nav__link">
    Untransformed String Forward References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/drivendataorg/erdantic/edit/master/docs/forward-references.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="handling-forward-references">Handling Forward References<a class="headerlink" href="#handling-forward-references" title="Permanent link">&para;</a></h1>
<p><a href="https://www.python.org/dev/peps/pep-0484/#forward-references">Forward references</a> are type annotations which use a string literal to declare a name that hasn't been defined yet in the code. The annotation is stored as just the name and the reference to the object is resolved later. Forward references are often useful when a class' type hints need to reference itself, or when you need to avoid a circular import through <code>if typing.TYPE_CHECKING</code>.</p>
<p>Dealing with forward reference resolution is somewhat tricky. In the best case, your forward references are already resolved, and erdantic will work without any issue. Otherwise, the following sections will provide some examples of expected errors and what to do.</p>
<h2 id="unevaluated-forward-references">Unevaluated Forward References<a class="headerlink" href="#unevaluated-forward-references" title="Permanent link">&para;</a></h2>
<p>Forward references must be evaluated along with the right namespace in order to properly resolve them to the correct class. If you are using forward references and they are unresolved, erdantic will error with an <code>UnevaluatedForwardRefError</code>. The exception message will provide some information about how to resolve the forward references.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Pydantic</label><label for="__tabbed_1_2">dataclasses</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">erdantic</span> <span class="k">as</span> <span class="nn">erd</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span> <span class="nc">Container</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">contains</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="c1"># Error because forward reference is unresolved</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">Container</span><span class="p">)</span>
<span class="c1">#&gt; Traceback (most recent call last):</span>
<span class="c1">#&gt;   File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 192, in create</span>
<span class="c1">#&gt;     search_composition_graph(model=model, seen_models=seen_models, seen_edges=seen_edges)</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 241, in search_composition_graph</span>
<span class="c1">#&gt;     raise UnevaluatedForwardRefError(</span>
<span class="c1">#&gt; erdantic.exceptions.UnevaluatedForwardRefError: Unevaluated forward reference &#39;Item&#39; for field contains on model Container. Call &#39;update_forward_refs&#39; after model is created to resolve. See: https://pydantic-docs.helpmanual.io/usage/postponed_annotations/</span>

<span class="c1"># Explicitly force evaluation</span>
<span class="n">Container</span><span class="o">.</span><span class="n">update_forward_refs</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>

<span class="c1"># Now this works fine</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">Container</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">edges</span>
<span class="c1">#&gt; [ Edge(source=PydanticModel(Container), source_field=&lt;PydanticField: &#39;contains&#39;, List[Item]&gt;, target=PydanticModel(Item))]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">get_type_hints</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">erdantic</span> <span class="k">as</span> <span class="nn">erd</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Container</span><span class="p">:</span>
    <span class="n">contains</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">]</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Item</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="c1"># Error because forward reference is unresolved</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">Container</span><span class="p">)</span>
<span class="c1">#&gt; Traceback (most recent call last):</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/miniconda3/envs/erdantic39/lib/python3.9/site-packages/reprexlite/code.py&quot;, line 71, in evaluate</span>
<span class="c1">#&gt;     exec(str(self).strip(), scope, scope)</span>
<span class="c1">#&gt;   File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 192, in create</span>
<span class="c1">#&gt;     search_composition_graph(model=model, seen_models=seen_models, seen_edges=seen_edges)</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 241, in search_composition_graph</span>
<span class="c1">#&gt;     raise UnevaluatedForwardRefError(</span>
<span class="c1">#&gt; erdantic.exceptions.UnevaluatedForwardRefError: Unevaluated forward reference &#39;Item&#39; for field contains on model Container. Call &#39;typing.get_type_hints&#39; on your dataclass after creating it to resolve.</span>

<span class="c1"># Explicitly force evaluation</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">localns</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span>

<span class="c1"># Now this works fine</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">Container</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">edges</span>
<span class="c1">#&gt; [ Edge(source=DataClassModel(Container), source_field=&lt;DataClassField: &#39;contains&#39;, List[Item]&gt;, target=DataClassModel(Item))]</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="untransformed-string-forward-references">Untransformed String Forward References<a class="headerlink" href="#untransformed-string-forward-references" title="Permanent link">&para;</a></h2>
<p>Under the hood, forward references usually—but not always—get converted from a string to a <code>typing.ForwardRef</code> (or in Python &lt;3.7.4, <code>typing._ForwardRef</code>) instances. These objects track metadata about the type annotation, including what they get evaluated to.</p>
<p>Unfortunately, sometimes the annotations remain as unconverted strings, and erdantic is unable to handle those cases. In such cases, erdantic will error with a <code>StringForwardRefError</code>. To work around that, you can explicitly declare those annotations with <code>typing.ForwardRef</code> (or <code>typing._ForwardRef</code> for Python &lt;3.7.4).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Pydantic</label><label for="__tabbed_2_2">dataclasses</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Pydantic does this automatically and doesn't need any further intervention.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">erdantic</span> <span class="k">as</span> <span class="nn">erd</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span> <span class="nc">SingleContainer</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">contains</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span>


<span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="c1"># Works without any issues</span>
<span class="n">SingleContainer</span><span class="o">.</span><span class="n">update_forward_refs</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">SingleContainer</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">edges</span>
<span class="c1">#&gt; [ Edge(source=PydanticModel(SingleContainer), source_field=&lt;PydanticField: &#39;contains&#39;, Item&gt;, target=PydanticModel(Item))]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>dataclasses sometimes do not convert from strings and require explicit use of <code>typing.ForwardRef</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">get_type_hints</span><span class="p">,</span> <span class="n">ForwardRef</span>

<span class="kn">import</span> <span class="nn">erdantic</span> <span class="k">as</span> <span class="nn">erd</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SingleContainer</span><span class="p">:</span>
    <span class="n">contains</span><span class="p">:</span> <span class="s2">&quot;Item&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Item</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="c1"># Errors because string annotation is unconverted</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">SingleContainer</span><span class="p">,</span> <span class="n">localns</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">SingleContainer</span><span class="p">)</span>
<span class="c1">#&gt; Traceback (most recent call last):</span>
<span class="c1">#&gt;   File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 192, in create</span>
<span class="c1">#&gt;     search_composition_graph(model=model, seen_models=seen_models, seen_edges=seen_edges)</span>
<span class="c1">#&gt;   File &quot;/Users/jqi/repos/erdantic/erdantic/erd.py&quot;, line 245, in search_composition_graph</span>
<span class="c1">#&gt;     raise StringForwardRefError(</span>
<span class="c1">#&gt; erdantic.exceptions.StringForwardRefError: Forward reference &#39;Item&#39; for field &#39;contains&#39; on model &#39;SingleContainer&#39; is a string literal and not a typing.ForwardRef object. erdantic is unable to handle forward references that aren&#39;t transformed into typing.ForwardRef. Declare explicitly with &#39;typing.ForwardRef(&quot;Item&quot;, is_argument=False)&#39;.</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">FixedSingleContainer</span><span class="p">:</span>
    <span class="n">contains</span><span class="p">:</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="n">is_argument</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="c1"># Now this works fine</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">FixedSingleContainer</span><span class="p">,</span> <span class="n">localns</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">erd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">FixedSingleContainer</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">edges</span>
<span class="c1">#&gt; [ Edge(source=DataClassModel(FixedSingleContainer), source_field=&lt;DataClassField: &#39;contains&#39;, Item&gt;, target=DataClassModel(Item))]</span>
</code></pre></div>
</div>
</div>
</div>
<p><sup>Examples created with <a href="https://github.com/jayqi/reprexlite">reprexlite</a>.</sup></p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../examples/dataclasses/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Usage Example: dataclasses" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Usage Example: dataclasses
            </div>
          </div>
        </a>
      
      
        
        <a href="../extending/" class="md-footer__link md-footer__link--next" aria-label="Next: Adding New Frameworks" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Adding New Frameworks
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
    
  </body>
</html>